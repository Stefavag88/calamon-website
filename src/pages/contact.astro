---
import Layout from "../layouts/Layout.astro";

// success / error query handling
const q = new URL(Astro.request.url).searchParams;
const success = q.get("success") === "1";
const error = q.get("error") === "1";
---

<Layout title="Contact Calamon" description="Get in touch to plan your stay in Episkopi, Crete">
  <main>
    <!-- Hero header -->
    <section class="relative h-[40svh]">
      <img src="/images/home/hero6.jpg" alt="" class="absolute inset-0 h-full w-full object-cover" />
      <div class="absolute inset-0 bg-black/40"></div>
      <div class="relative z-10 h-full flex items-center justify-center text-center px-6">
        <div class="max-w-2xl">
          <h1 class="text-white text-4xl sm:text-5xl font-serif">Get in touch</h1>
          <p class="mt-3 text-white/90">We’ll reply within 24 hours.</p>
        </div>
      </div>
    </section>

    <!-- Contact Form -->
    <section class="mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 py-16">
      {success && (
        <div class="mb-6 rounded-lg border border-emerald-300 bg-emerald-50 px-4 py-3 text-emerald-800">
          ✅ Thank you — your message has been sent. We’ll get back to you shortly.
        </div>
      )}
      {error && (
        <div class="mb-6 rounded-lg border border-red-300 bg-red-50 px-4 py-3 text-red-800">
          ❌ Something went wrong. Please try again or email us at <a href="mailto:info@calamon.com" class="underline">info@calamon.com</a>.
        </div>
      )}

      <form
        name="contact"
        method="POST"
        data-netlify="true"
        netlify-honeypot="website"
        action="/contact?success=1"
        class="rounded-[var(--radius)] bg-[var(--color-surface)] p-6 sm:p-8 shadow-[var(--shadow-soft)]"
      >
        <!-- Netlify required hidden input -->
        <input type="hidden" name="form-name" value="contact" />
        <!-- Honeypot -->
        <input type="text" name="website" class="hidden" tabindex="-1" autocomplete="off" aria-hidden="true" />

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
          <div>
            <label for="name" class="block text-sm font-medium">Full name</label>
            <input
              id="name" name="name" type="text" required
              class="mt-2 w-full rounded-lg border border-[var(--color-border)] bg-white px-3 py-2 outline-none focus:ring-2 focus:ring-[var(--color-brand)]"
              placeholder="e.g., Maria Papadopoulou"
            />
          </div>

          <div>
            <label for="email" class="block text-sm font-medium">Email</label>
            <input
              id="email" name="email" type="email" required
              class="mt-2 w-full rounded-lg border border-[var(--color-border)] bg-white px-3 py-2 outline-none focus:ring-2 focus:ring-[var(--color-brand)]"
              placeholder="you@example.com"
            />
          </div>

          <div>
            <label for="phone" class="block text-sm font-medium">Phone (optional)</label>
            <input
              id="phone" name="phone" type="tel"
              class="mt-2 w-full rounded-lg border border-[var(--color-border)] bg-white px-3 py-2 outline-none focus:ring-2 focus:ring-[var(--color-brand)]"
              placeholder="+30 xxx xxx xxxx"
            />
          </div>

          <div>
            <label for="dates" class="block text-sm font-medium">Preferred dates (optional)</label>
            <input
              id="dates" name="dates" type="text"
              class="mt-2 w-full rounded-lg border border-[var(--color-border)] bg-white px-3 py-2 outline-none focus:ring-2 focus:ring-[var(--color-brand)]"
              placeholder="e.g., 15–20 Sept"
            />
          </div>
        </div>

        <div class="mt-5">
          <label for="message" class="block text-sm font-medium">Message</label>
          <textarea
            id="message" name="message" rows={6} required
            class="mt-2 w-full rounded-lg border border-[var(--color-border)] bg-white px-3 py-2 outline-none focus:ring-2 focus:ring-[var(--color-brand)]"
            placeholder="Tell us a bit about your trip, number of guests, special requests…"
          ></textarea>
        </div>

        <div class="mt-5 flex items-start gap-3">
          <input id="consent" name="consent" type="checkbox" required class="mt-1 h-4 w-4 rounded border-[var(--color-border)]" />
          <label for="consent" class="text-sm text-[var(--color-muted)]">
            I consent to having this website store my submitted information so we can respond.
          </label>
        </div>

        <div class="mt-8">
          <button
            type="submit"
            class="rounded-full border border-[var(--color-brand)] text-[var(--color-brand)]
                   px-8 py-3 text-lg tracking-wide hover:bg-[var(--color-brand)] hover:text-white transition"
          >
            Send message
          </button>
        </div>
      </form>

      <!-- Alt contact -->
      <p class="mt-6 text-sm text-[var(--color-muted)]">
        Prefer email? Write to <a href="mailto:info@calamon.com" class="underline">info@calamon.com</a>.
      </p>
    </section>
  </main>
</Layout>
